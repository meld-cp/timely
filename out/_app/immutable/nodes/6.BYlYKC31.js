var gt=Object.defineProperty;var ct=e=>{throw TypeError(e)};var pt=(e,t,a)=>t in e?gt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var B=(e,t,a)=>pt(e,typeof t!="symbol"?t+"":t,a),Tt=(e,t,a)=>t.has(e)||ct("Cannot "+a);var j=(e,t,a)=>(Tt(e,t,"read from private field"),a?a.call(e):t.get(e)),q=(e,t,a)=>t.has(e)?ct("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,a);import{a as R,t as F,c as nt}from"../chunks/disclose-version.090F9Z5W.js";import{E as yt,aM as bt,aN as St,am as wt,l as xt,V as vt,aO as At,at as Rt,e as U,aP as Ct,aq as ut,$ as lt,ar as Dt,p as at,c as l,s as b,t as H,r as d,a as et,q as D,w as V,f as tt,n as _t,R as O,ad as W}from"../chunks/runtime.Zs8r3Oqx.js";import{a as Ft,s as I}from"../chunks/render.CTDoikuL.js";import{p as E}from"../chunks/proxy.RlL82DbB.js";import{o as Pt,a as It}from"../chunks/index-client.DuqHwBsT.js";import{T as g,e as Mt,a as rt,F as zt}from"../chunks/ViewModels.svelte.CFd1dAF6.js";import{i as N}from"../chunks/if.Dc9nQdRi.js";import{a as dt,r as Z,t as it}from"../chunks/Singletons.BCH7qXIm.js";import{d as ht,e as jt}from"../chunks/events.DJoDsz3Y.js";import{b as $}from"../chunks/input.DTKRrwQR.js";import{p as Et}from"../chunks/props.BAByPRWC.js";function Ht(e,t,a){if(a){if(e.classList.contains(t))return;e.classList.add(t)}else{if(!e.classList.contains(t))return;e.classList.remove(t)}}const Lt=()=>performance.now(),L={tick:e=>requestAnimationFrame(e),now:()=>Lt(),tasks:new Set};function mt(){const e=L.now();L.tasks.forEach(t=>{t.c(e)||(L.tasks.delete(t),t.f())}),L.tasks.size!==0&&L.tick(mt)}function Nt(e){let t;return L.tasks.size===0&&L.tick(mt),{promise:new Promise(a=>{L.tasks.add(t={c:e,f:a})}),abort(){L.tasks.delete(t)}}}function X(e,t){e.dispatchEvent(new CustomEvent(t))}function Bt(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(a=>a[0].toUpperCase()+a.slice(1)).join("")}function ft(e){const t={},a=e.split(";");for(const s of a){const[c,u]=s.split(":");if(!c||u===void 0)break;const i=Bt(c.trim());t[i]=u.trim()}return t}const Ot=e=>e;function qt(e,t,a,s){var c=(e&Ct)!==0,u="both",i,p=t.inert,w=t.style.overflow,o,v;function C(){var y=Dt,_=vt;ut(null),lt(null);try{return i??(i=a()(t,(s==null?void 0:s())??{},{direction:u}))}finally{ut(y),lt(_)}}var f={is_global:c,in(){t.inert=p,X(t,"introstart"),o=ot(t,C(),v,1,()=>{X(t,"introend"),o==null||o.abort(),o=i=void 0,t.style.overflow=w})},out(y){t.inert=!0,X(t,"outrostart"),v=ot(t,C(),o,0,()=>{X(t,"outroend"),y==null||y()})},stop:()=>{o==null||o.abort(),v==null||v.abort()}},k=vt;if((k.transitions??(k.transitions=[])).push(f),Ft){var h=c;if(!h){for(var n=k.parent;n&&n.f&yt;)for(;(n=n.parent)&&!(n.f&bt););h=!n||(n.f&St)!==0}h&&wt(()=>{xt(()=>f.in())})}}function ot(e,t,a,s,c){var u=s===1;if(At(t)){var i,p=!1;return Rt(()=>{if(!p){var y=t({direction:u?"in":"out"});i=ot(e,y,a,s,c)}}),{abort:()=>{p=!0,i==null||i.abort()},deactivate:()=>i.deactivate(),reset:()=>i.reset(),t:()=>i.t()}}if(a==null||a.deactivate(),!(t!=null&&t.duration))return c(),{abort:U,deactivate:U,reset:U,t:()=>s};const{delay:w=0,css:o,tick:v,easing:C=Ot}=t;var f=[];if(u&&a===void 0&&(v&&v(0,1),o)){var k=ft(o(0,1));f.push(k,k)}var h=()=>1-s,n=e.animate(f,{duration:w});return n.onfinish=()=>{var y=(a==null?void 0:a.t())??1-s;a==null||a.abort();var _=s-y,P=t.duration*Math.abs(_),z=[];if(P>0){var T=!1;if(o)for(var m=Math.ceil(P/16.666666666666668),A=0;A<=m;A+=1){var r=y+_*C(A/m),x=ft(o(r,1-r));z.push(x),T||(T=x.overflow==="hidden")}T&&(e.style.overflow="hidden"),h=()=>{var S=n.currentTime;return y+_*C(S/P)},v&&Nt(()=>{if(n.playState!=="running")return!1;var S=h();return v(S,1-S),!0})}n=e.animate(z,{duration:P,fill:"forwards"}),n.onfinish=()=>{h=()=>s,v==null||v(s,1-s),c()}},{abort:()=>{n&&(n.cancel(),n.effect=null,n.onfinish=U)},deactivate:()=>{c=U},reset:()=>{s===0&&(v==null||v(1,0))},t:()=>h()}}var Ut=(e,t)=>t.onIncreaseDuration(!0,e.ctrlKey),Vt=(e,t)=>t.onIncreaseDuration(!1,e.ctrlKey),Wt=F('<div class="c-buttons svelte-570ij9"><button class="outline svelte-570ij9" title="Add Time">+</button> <button class="outline svelte-570ij9" title="Remove Time">-</button></div>'),Kt=(e,t)=>t.onAction1Click(),Gt=F('<button class="outline svelte-570ij9"> </button>'),Jt=F('<div class="icon"> </div>'),Qt=(e,t)=>t.onAction2Click(),Xt=F('<button class="outline secondary svelte-570ij9"> </button>'),Yt=F('<div class="icon"> </div>'),Zt=F('<div class="c-buttons svelte-570ij9"><!> <!></div>'),$t=F('<div class="c-main svelte-570ij9"><!> <div class="affective svelte-570ij9"> </div> <div class="counter svelte-570ij9" style="text-align: right; line-height: 1.4em; font-family: monospace;"> </div> <!></div>');function ta(e,t){at(t,!0);let a=V(()=>{const f=Math.floor(Math.abs(t.durationSeconds)/60/60),k=Math.floor(Math.abs(t.durationSeconds/60)),h=Math.abs(k%60),n=Math.abs(t.durationSeconds%60),y=[f.toFixed(0)+"h",h.toFixed(0)+"m",n.toFixed(0)+"s"];return(t.durationSeconds<0?"-":"")+y.join(" ")});var s=$t(),c=l(s);{var u=f=>{var k=Wt(),h=l(k);h.__click=[Ut,t];var n=b(h,2);n.__click=[Vt,t],d(k),R(f,k)};N(c,f=>{t.onIncreaseDuration&&f(u)})}var i=b(c,2),p=l(i,!0);H(()=>{var f;return I(p,(f=t.affectiveDurationHours)==null?void 0:f.toFixed(2))}),d(i);var w=b(i,2),o=l(w,!0);d(w);var v=b(w,2);{var C=f=>{var k=Zt(),h=l(k);{var n=T=>{var m=Gt();m.__click=[Kt,t];var A=l(m,!0);d(m),H(()=>{dt(m,"title",t.action1Hint),I(A,t.icon1)}),R(T,m)},y=T=>{var m=nt(),A=tt(m);{var r=x=>{var S=Jt(),st=l(S,!0);d(S),H(()=>I(st,t.icon1)),R(x,S)};N(A,x=>{t.icon1&&x(r)},!0)}R(T,m)};N(h,T=>{t.onAction1Click?T(n):T(y,!1)})}var _=b(h,2);{var P=T=>{var m=Xt();m.__click=[Qt,t];var A=l(m,!0);d(m),H(()=>{dt(m,"title",t.action2Hint),I(A,t.icon2)}),R(T,m)},z=T=>{var m=nt(),A=tt(m);{var r=x=>{var S=Yt(),st=l(S,!0);d(S),H(()=>I(st,t.icon2)),R(x,S)};N(A,x=>{t.icon2&&x(r)},!0)}R(T,m)};N(_,T=>{t.onAction2Click?T(P):T(z,!1)})}d(k),R(f,k)};N(v,f=>{(t.icon1||t.onAction1Click||t.icon2||t.onAction2Click)&&f(C)})}d(s),H(()=>I(o,D(a))),R(e,s),et()}ht(["click"]);class M{}B(M,"TaskPause","⏸️"),B(M,"TaskResume","▶️"),B(M,"TaskStop","⏹️"),B(M,"TaskDuplicateAndStart","⏫");function kt(e,t,a){t.taskController.saveTask(a())}var aa=F('<span style="flex: content;" class="inv" title="Invoice"> </span>'),ea=(e,t,a)=>{var s;return(s=t.taskController)==null?void 0:s.saveTask(a())},sa=(e,t,a)=>t.taskController.deleteTask(a()),ra=F('<article class="c-task svelte-1az4vks"><div class="c-task-fields svelte-1az4vks"><input class="date svelte-1az4vks" name="task-date" type="date" title="Date"> <input class="name svelte-1az4vks" name="task-name" type="text" title="Description" placeholder="Description"> <div class="c-task-fields-row-2 svelte-1az4vks"><details class="svelte-1az4vks"><summary class="svelte-1az4vks">Other</summary> <!> <div style="display: flex; flex-direction: row; gap:1rem; flex-wrap: wrap;"><input style="flex: 10;" class="tags svelte-1az4vks" name="task-tags" type="text" placeholder="Tags" title="Tags"> <button style="flex: content;" class="svelte-1az4vks">Delete</button></div></details> <div style="flex: 2;"></div></div></div> <div class="c-task-duration svelte-1az4vks"><!></div></article>');function ia(e,t){at(t,!0);let a=Et(t,"vm",7);const s={icon:r=>{switch(r.state){case g.Running:return M.TaskPause;case g.Paused:return M.TaskResume;case g.Stopped:return M.TaskDuplicateAndStart}},hint:r=>{switch(r.state){case g.Running:return"Pause";case g.Paused:return"Resume";case g.Stopped:return"Start a new copy"}},execute:r=>{switch(r.state){case g.Running:t.taskController.pauseTask(r);break;case g.Paused:t.taskController.startTask(r);break;case g.Stopped:t.taskController.duplicateAndStartTask(r);break}}},c={icon:r=>{switch(r.state){case g.Running:return M.TaskStop;case g.Paused:return M.TaskStop;case g.Stopped:return M.TaskResume}},hint:r=>{switch(r.state){case g.Running:return"Stop";case g.Paused:return"Stop";case g.Stopped:return"Start"}},execute:r=>{switch(r.state){case g.Running:t.taskController.stopTask(r);break;case g.Paused:t.taskController.stopTask(r);break;case g.Stopped:t.taskController.startTask(r);break}}};function u(r,x){let S=x?1:15;t.taskController.increaseDuration(a(),r?S:-S)}var i=ra(),p=l(i),w=l(p);Z(w),w.__input=[kt,t,a];var o=b(w,2);Z(o),o.__input=[kt,t,a];var v=b(o,2),C=l(v),f=b(l(C),2);{var k=r=>{var x=aa(),S=l(x);d(x),H(()=>I(S,`Attached to Invoice Id: ${a().invoiceRefId??""}`)),R(r,x)};N(f,r=>{a().invoiceRefId.length>0&&r(k)})}var h=b(f,2),n=l(h);Z(n),n.__input=[ea,t,a];var y=b(n,2);y.__click=[sa,t,a],d(h),d(C),_t(2),d(v),d(p);var _=b(p,2),P=l(_),z=V(()=>s.icon(a())),T=V(()=>s.hint(a())),m=V(()=>c.icon(a())),A=V(()=>c.hint(a()));ta(P,{get durationSeconds(){return a().duration},get affectiveDurationHours(){return a().affectiveDurationHours},onIncreaseDuration:u,get icon1(){return D(z)},onAction1Click:()=>s.execute(a()),get action1Hint(){return D(T)},get icon2(){return D(m)},onAction2Click:()=>c.execute(a()),get action2Hint(){return D(A)}}),d(_),d(i),H(()=>Ht(i,"s-running",a().state==g.Running)),$(w,()=>a().date,r=>a().date=r),$(o,()=>a().name,r=>a().name=r),$(n,()=>a().tagsAsText,r=>a().tagsAsText=r),R(e,i),et()}ht(["input","click"]);function na(e){const t=e-1;return t*t*t+1}function oa(e,{delay:t=0,duration:a=400,easing:s=na,axis:c="y"}={}){const u=getComputedStyle(e),i=+u.opacity,p=c==="y"?"height":"width",w=parseFloat(u[p]),o=c==="y"?["top","bottom"]:["left","right"],v=o.map(_=>`${_[0].toUpperCase()}${_.slice(1)}`),C=parseFloat(u[`padding${v[0]}`]),f=parseFloat(u[`padding${v[1]}`]),k=parseFloat(u[`margin${v[0]}`]),h=parseFloat(u[`margin${v[1]}`]),n=parseFloat(u[`border${v[0]}Width`]),y=parseFloat(u[`border${v[1]}Width`]);return{delay:t,duration:a,easing:s,css:_=>`overflow: hidden;opacity: ${Math.min(_*20,1)*i};${p}: ${_*w}px;padding-${o[0]}: ${_*C}px;padding-${o[1]}: ${_*f}px;margin-${o[0]}: ${_*k}px;margin-${o[1]}: ${_*h}px;border-${o[0]}-width: ${_*n}px;border-${o[1]}-width: ${_*y}px;min-${p}: 0`}}var ca=F("<div><!></div>");function Y(e,t){var a=nt(),s=tt(a);Mt(s,19,()=>t.tasks,c=>c.id,(c,u)=>{var i=ca(),p=l(i);ia(p,{get vm(){return D(u)},get taskController(){return t.taskController}}),d(i),qt(3,i,()=>oa,()=>({duration:200})),R(c,i)}),R(e,a)}var va=F('<form><fieldset role="group" class="svelte-1ps283u"><input id="taskname" type="text" placeholder="Whatcha doin?" autocorrect="on" autocomplete="on"> <input type="submit" value="Start" class="svelte-1ps283u"></fieldset></form>');function ua(e,t){at(t,!0);let a=W("");function s(p){p.preventDefault(),t.onStartTask(D(a)),O(a,"")}var c=va(),u=l(c),i=l(u);Z(i),_t(2),d(u),d(c),jt("submit",c,s),$(i,()=>D(a),p=>O(a,p)),R(e,c),et()}var K,G,J,Q;class la{constructor(){q(this,K,W(E([])));q(this,G,W(E([])));q(this,J,W(E([])));q(this,Q,W(E([])));B(this,"intervalId")}get tasksRunning(){return D(j(this,K))}set tasksRunning(t){O(j(this,K),E(t))}get tasksPaused(){return D(j(this,G))}set tasksPaused(t){O(j(this,G),E(t))}get tasksStopped(){return D(j(this,J))}set tasksStopped(t){O(j(this,J),E(t))}get tasksArchived(){return D(j(this,Q))}set tasksArchived(t){O(j(this,Q),E(t))}start(){this.stop(),this.refresh();for(const t of this.tasksRunning)t.recalculateDurationFromRunningSession();this.intervalId=setInterval(()=>this.incrementRunningTaskDuration(),1e3)}stop(){this.intervalId&&clearInterval(this.intervalId)}refresh(){const t=it.getAll().map(a=>new rt(a));this.tasksRunning=this.fetchTasksByState(t,[g.Running]),this.tasksPaused=this.fetchTasksByState(t,[g.Paused]),this.tasksStopped=this.fetchTasksByState(t,[g.Stopped]),this.tasksArchived=this.fetchTasksByState(t,[g.Archived])}fetchTasksByState(t,a){return t.filter(s=>a.includes(s.state))}startNewTask(t){const a=new rt;a.name=t,this.startTask(a)}saveTask(t){it.set(t.id,t.getModel())}pauseAll(){this.refresh();for(const t of this.tasksRunning)t.pause(),this.saveTask(t);this.refresh()}incrementRunningTaskDuration(){for(const t of this.tasksRunning)t.setDuration(t.duration+1),this.saveTask(t)}pauseTask(t){t.pause(),this.saveTask(t),this.refresh()}startTask(t){this.pauseAll(),t.start(),this.saveTask(t),this.refresh()}stopTask(t){t.stop(),this.saveTask(t),this.refresh()}duplicateAndStartTask(t){const a=new rt(t.getModel(crypto.randomUUID()));a.setDuration(0),a.date=zt.toInputDateValue(new Date),a.invoiceRefId="",this.startTask(a)}increaseDuration(t,a){t.incrementDuration(a),this.saveTask(t)}deleteTask(t){it.remove(t.id),this.refresh()}}K=new WeakMap,G=new WeakMap,J=new WeakMap,Q=new WeakMap;var da=F("<h1>Time Log</h1> <!> <section><summary> </summary> <!></section> <section><summary> </summary> <!></section> <section><details><summary> </summary> <!></details></section> <section><details><summary> </summary> <!></details></section>",1);function xa(e,t){at(t,!0);let a=E(new la);Pt(()=>{a.start()}),It(()=>{a.stop()});var s=da(),c=b(tt(s),2);ua(c,{onStartTask:r=>a.startNewTask(r)});var u=b(c,2),i=l(u),p=l(i);d(i);var w=b(i,2);Y(w,{get taskController(){return a},get tasks(){return a.tasksRunning}}),d(u);var o=b(u,2),v=l(o),C=l(v);d(v);var f=b(v,2);Y(f,{get taskController(){return a},get tasks(){return a.tasksPaused}}),d(o);var k=b(o,2),h=l(k),n=l(h),y=l(n);d(n);var _=b(n,2);Y(_,{get taskController(){return a},get tasks(){return a.tasksStopped}}),d(h),d(k);var P=b(k,2),z=l(P),T=l(z),m=l(T);d(T);var A=b(T,2);Y(A,{get taskController(){return a},get tasks(){return a.tasksArchived}}),d(z),d(P),H(()=>{I(p,`In Progress (${a.tasksRunning.length??""})`),I(C,`Paused (${a.tasksPaused.length??""})`),I(y,`Stopped (${a.tasksStopped.length??""})`),I(m,`Archived (${a.tasksArchived.length??""})`)}),R(e,s),et()}export{xa as component};
