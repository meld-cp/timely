var St=Object.defineProperty;var ft=e=>{throw TypeError(e)};var wt=(e,t,a)=>t in e?St(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var O=(e,t,a)=>wt(e,typeof t!="symbol"?t+"":t,a),At=(e,t,a)=>t.has(e)||ft("Cannot "+a);var F=(e,t,a)=>(At(e,t,"read from private field"),a?a.call(e):t.get(e)),K=(e,t,a)=>t.has(e)?ft("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,a);import{a as w,t as D,c as lt}from"../chunks/C6I-1lhn.js";import{E as Ct,aK as Rt,aL as Dt,x as Pt,k as zt,N as kt,ar as Ft,z as It,n as J,aM as Mt,aC as _t,af as mt,Z as Lt,p as ot,c as l,s as y,r as u,t as B,o as b,a as ct,v as E,f as nt,ab as Tt,a7 as N,ac as V}from"../chunks/C1YrOOk_.js";import{b as jt,s as U}from"../chunks/hnnBCjZc.js";import{p as I}from"../chunks/BR_3dH_1.js";import{o as Et,a as qt}from"../chunks/BrNznxSd.js";import{e as yt,i as Ht}from"../chunks/D1umluFs.js";import{i as H}from"../chunks/C3MGylT0.js";import{s as ht,r as rt}from"../chunks/BwTxTwW6.js";import{d as xt,g as Nt}from"../chunks/lOenb5ZA.js";import{b as it}from"../chunks/6U0v1yO8.js";import{p as Ut}from"../chunks/DHNG16Ra.js";import{I as W,a as Bt,b as Ot,c as Kt,d as Wt,e as Vt,g as Gt}from"../chunks/WuI6RMP2.js";import{T as g,a as ut}from"../chunks/DpGbcKUU.js";import{t as vt,F as Zt}from"../chunks/CAlEHurm.js";function Jt(e,t,a){if(a){if(e.classList.contains(t))return;e.classList.add(t)}else{if(!e.classList.contains(t))return;e.classList.remove(t)}}const Qt=()=>performance.now(),q={tick:e=>requestAnimationFrame(e),now:()=>Qt(),tasks:new Set};function bt(){const e=q.now();q.tasks.forEach(t=>{t.c(e)||(q.tasks.delete(t),t.f())}),q.tasks.size!==0&&q.tick(bt)}function Xt(e){let t;return q.tasks.size===0&&q.tick(bt),{promise:new Promise(a=>{q.tasks.add(t={c:e,f:a})}),abort(){q.tasks.delete(t)}}}function et(e,t){e.dispatchEvent(new CustomEvent(t))}function Yt(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(a=>a[0].toUpperCase()+a.slice(1)).join("")}function pt(e){const t={},a=e.split(";");for(const r of a){const[c,d]=r.split(":");if(!c||d===void 0)break;const i=Yt(c.trim());t[i]=d.trim()}return t}const $t=e=>e;function ta(e,t,a,r){var c=(e&Mt)!==0,d="both",i,x=t.inert,S=t.style.overflow,s,n;function A(){var h=Lt,m=kt;_t(null),mt(null);try{return i??(i=a()(t,(r==null?void 0:r())??{},{direction:d}))}finally{_t(h),mt(m)}}var v={is_global:c,in(){t.inert=x,et(t,"introstart"),s=dt(t,A(),n,1,()=>{et(t,"introend"),s==null||s.abort(),s=i=void 0,t.style.overflow=S})},out(h){t.inert=!0,et(t,"outrostart"),n=dt(t,A(),s,0,()=>{et(t,"outroend"),h==null||h()})},stop:()=>{s==null||s.abort(),n==null||n.abort()}},f=kt;if((f.transitions??(f.transitions=[])).push(v),jt){var k=c;if(!k){for(var o=f.parent;o&&o.f&Ct;)for(;(o=o.parent)&&!(o.f&Rt););k=!o||(o.f&Dt)!==0}k&&Pt(()=>{zt(()=>v.in())})}}function dt(e,t,a,r,c){var d=r===1;if(Ft(t)){var i,x=!1;return It(()=>{if(!x){var h=t({direction:d?"in":"out"});i=dt(e,h,a,r,c)}}),{abort:()=>{x=!0,i==null||i.abort()},deactivate:()=>i.deactivate(),reset:()=>i.reset(),t:()=>i.t()}}if(a==null||a.deactivate(),!(t!=null&&t.duration))return c(),{abort:J,deactivate:J,reset:J,t:()=>r};const{delay:S=0,css:s,tick:n,easing:A=$t}=t;var v=[];if(d&&a===void 0&&(n&&n(0,1),s)){var f=pt(s(0,1));v.push(f,f)}var k=()=>1-r,o=e.animate(v,{duration:S});return o.onfinish=()=>{var h=(a==null?void 0:a.t())??1-r;a==null||a.abort();var m=r-h,z=t.duration*Math.abs(m),j=[];if(z>0){var T=!1;if(s)for(var p=Math.ceil(z/16.666666666666668),C=0;C<=p;C+=1){var M=h+m*A(C/p),P=pt(s(M,1-M));j.push(P),T||(T=P.overflow==="hidden")}T&&(e.style.overflow="hidden"),k=()=>{var R=o.currentTime;return h+m*A(R/z)},n&&Xt(()=>{if(o.playState!=="running")return!1;var R=k();return n(R,1-R),!0})}o=e.animate(j,{duration:z,fill:"forwards"}),o.onfinish=()=>{k=()=>r,n==null||n(r,1-r),c()}},{abort:()=>{o&&(o.cancel(),o.effect=null,o.onfinish=J)},deactivate:()=>{c=J},reset:()=>{r===0&&(n==null||n(1,0))},t:()=>k()}}var aa=(e,t)=>t.onIncreaseDuration(!0,e.ctrlKey),ea=(e,t)=>t.onIncreaseDuration(!1,e.ctrlKey),sa=D('<div class="c-buttons svelte-1ifz5q4"><button class="outline svelte-1ifz5q4" title="Add Time"><!></button> <button class="outline svelte-1ifz5q4" title="Remove Time"><!></button></div>'),ra=(e,t)=>t.onAction1Click(),ia=D('<button class="outline svelte-1ifz5q4"><!></button>'),na=D('<div class="icon"><!></div>'),oa=(e,t)=>t.onAction2Click(),ca=D('<button class="outline secondary svelte-1ifz5q4"><!></button>'),ua=D('<div class="icon secondary"><!></div>'),va=D('<div class="c-buttons svelte-1ifz5q4"><!> <!></div>'),la=D('<div class="c-main svelte-1ifz5q4"><!> <div class="affective svelte-1ifz5q4"> </div> <div class="counter svelte-1ifz5q4"> </div> <!></div>');function da(e,t){ot(t,!0);let a=E(()=>{const v=Math.floor(Math.abs(t.durationSeconds)/60/60),f=Math.floor(Math.abs(t.durationSeconds/60)),k=Math.abs(f%60),o=Math.abs(t.durationSeconds%60),h=[v.toFixed(0)+"h",k.toFixed(0)+"m",o.toFixed(0)+"s"];return(t.durationSeconds<0?"-":"")+h.join(" ")});var r=la(),c=l(r);{var d=v=>{var f=sa(),k=l(f);k.__click=[aa,t];var o=l(k);W(o,{icon:Bt}),u(k);var h=y(k,2);h.__click=[ea,t];var m=l(h);W(m,{icon:Ot}),u(h),u(f),w(v,f)};H(c,v=>{t.onIncreaseDuration&&v(d)})}var i=y(c,2),x=l(i,!0);u(i);var S=y(i,2),s=l(S,!0);u(S);var n=y(S,2);{var A=v=>{var f=va(),k=l(f);{var o=T=>{var p=ia();p.__click=[ra,t];var C=l(p);W(C,{get icon(){return t.icon1}}),u(p),B(()=>ht(p,"title",t.action1Hint)),w(T,p)},h=T=>{var p=lt(),C=nt(p);{var M=P=>{var R=na(),G=l(R);W(G,{get icon(){return t.icon1}}),u(R),w(P,R)};H(C,P=>{t.icon1&&P(M)},!0)}w(T,p)};H(k,T=>{t.onAction1Click?T(o):T(h,!1)})}var m=y(k,2);{var z=T=>{var p=ca();p.__click=[oa,t];var C=l(p);W(C,{get icon(){return t.icon2}}),u(p),B(()=>ht(p,"title",t.action2Hint)),w(T,p)},j=T=>{var p=lt(),C=nt(p);{var M=P=>{var R=ua(),G=l(R);W(G,{get icon(){return t.icon2}}),u(R),w(P,R)};H(C,P=>{t.icon2&&P(M)},!0)}w(T,p)};H(m,T=>{t.onAction2Click?T(z):T(j,!1)})}u(f),w(v,f)};H(n,v=>{(t.icon1||t.onAction1Click||t.icon2||t.onAction2Click)&&v(A)})}u(r),B(v=>{U(x,v),U(s,b(a))},[()=>{var v;return(v=t.affectiveDurationHours)==null?void 0:v.toFixed(2)}]),w(e,r),ct()}xt(["click"]);class L{}O(L,"TaskPause",Kt),O(L,"TaskResume",Wt),O(L,"TaskStop",Vt),O(L,"TaskDuplicateAndStart",Gt);function gt(e,t,a){t.taskController.saveTask(a())}var fa=D('<span style="flex: content;" class="inv" title="Invoice"> </span>'),ka=(e,t,a)=>{var r;return(r=t.taskController)==null?void 0:r.saveTask(a())},_a=(e,t,a)=>t.taskController.deleteTask(a()),ma=D('<article class="c-task svelte-1jzxame"><div class="c-task-fields svelte-1jzxame"><input class="date svelte-1jzxame" name="task-date" type="date" title="Date"> <input class="name svelte-1jzxame" name="task-name" type="text" title="Description" placeholder="Description"> <div class="c-task-fields-row-2 svelte-1jzxame"><details class="svelte-1jzxame"><summary class="svelte-1jzxame">Other</summary> <!> <div style="display: flex; flex-direction: row; gap:1rem; flex-wrap: wrap;"><input style="flex: 10;" class="tags svelte-1jzxame" name="task-tags" type="text" placeholder="Tags" title="Tags"> <button style="flex: content;" class="svelte-1jzxame">Delete</button></div></details> <div style="flex: 2;"></div></div></div> <div class="c-task-duration svelte-1jzxame"><!></div></article>');function ha(e,t){ot(t,!0);let a=Ut(t,"vm",7);const r={icon:_=>{switch(_.state){case g.Running:return L.TaskPause;case g.Paused:return L.TaskResume;case g.Stopped:return L.TaskDuplicateAndStart}},hint:_=>{switch(_.state){case g.Running:return"Pause";case g.Paused:return"Resume";case g.Stopped:return"Start a new copy"}},execute:_=>{switch(_.state){case g.Running:t.taskController.pauseTask(_);break;case g.Paused:t.taskController.startTask(_);break;case g.Stopped:t.taskController.duplicateAndStartTask(_);break}}},c={icon:_=>{switch(_.state){case g.Running:return L.TaskStop;case g.Paused:return L.TaskStop;case g.Stopped:return L.TaskResume}},hint:_=>{switch(_.state){case g.Running:return"Stop";case g.Paused:return"Stop";case g.Stopped:return"Start"}},execute:_=>{switch(_.state){case g.Running:t.taskController.stopTask(_);break;case g.Paused:t.taskController.stopTask(_);break;case g.Stopped:t.taskController.startTask(_);break}}};function d(_,Z){let at=Z?1:15;t.taskController.increaseDuration(a(),_?at:-at)}var i=ma(),x=l(i),S=l(x);rt(S),S.__input=[gt,t,a];var s=y(S,2);rt(s),s.__input=[gt,t,a];var n=y(s,2),A=l(n),v=y(l(A),2);{var f=_=>{var Z=fa(),at=l(Z);u(Z),B(()=>U(at,`Attached to Invoice Id: ${a().invoiceRefId??""}`)),w(_,Z)};H(v,_=>{a().invoiceRefId.length>0&&_(f)})}var k=y(v,2),o=l(k);rt(o),o.__input=[ka,t,a];var h=y(o,2);h.__click=[_a,t,a],u(k),u(A),Tt(2),u(n),u(x);var m=y(x,2),z=l(m);const j=E(()=>r.icon(a()));var T=E(()=>b(j));const p=E(()=>r.hint(a()));var C=E(()=>b(p));const M=E(()=>c.icon(a()));var P=E(()=>b(M));const R=E(()=>c.hint(a()));var G=E(()=>b(R));da(z,{get durationSeconds(){return a().duration},get affectiveDurationHours(){return a().affectiveDurationHours},onIncreaseDuration:d,get icon1(){return b(T)},onAction1Click:()=>r.execute(a()),get action1Hint(){return b(C)},get icon2(){return b(P)},onAction2Click:()=>c.execute(a()),get action2Hint(){return b(G)}}),u(m),u(i),B(()=>Jt(i,"s-running",a().state==g.Running)),it(S,()=>a().date,_=>a().date=_),it(s,()=>a().name,_=>a().name=_),it(o,()=>a().tagsAsText,_=>a().tagsAsText=_),w(e,i),ct()}xt(["input","click"]);function pa(e){const t=e-1;return t*t*t+1}function ga(e,{delay:t=0,duration:a=400,easing:r=pa,axis:c="y"}={}){const d=getComputedStyle(e),i=+d.opacity,x=c==="y"?"height":"width",S=parseFloat(d[x]),s=c==="y"?["top","bottom"]:["left","right"],n=s.map(m=>`${m[0].toUpperCase()}${m.slice(1)}`),A=parseFloat(d[`padding${n[0]}`]),v=parseFloat(d[`padding${n[1]}`]),f=parseFloat(d[`margin${n[0]}`]),k=parseFloat(d[`margin${n[1]}`]),o=parseFloat(d[`border${n[0]}Width`]),h=parseFloat(d[`border${n[1]}Width`]);return{delay:t,duration:a,easing:r,css:m=>`overflow: hidden;opacity: ${Math.min(m*20,1)*i};${x}: ${m*S}px;padding-${s[0]}: ${m*A}px;padding-${s[1]}: ${m*v}px;margin-${s[0]}: ${m*f}px;margin-${s[1]}: ${m*k}px;border-${s[0]}-width: ${m*o}px;border-${s[1]}-width: ${m*h}px;min-${x}: 0`}}var Ta=D("<div><!></div>");function st(e,t){var a=lt(),r=nt(a);yt(r,19,()=>t.tasks,c=>c.id,(c,d)=>{var i=Ta(),x=l(i);ha(x,{get vm(){return b(d)},get taskController(){return t.taskController}}),u(i),ta(3,i,()=>ga,()=>({duration:200})),w(c,i)}),w(e,a)}var ya=D("<option></option>"),xa=D('<datalist id="list-task-names"></datalist>'),ba=D('<form><fieldset role="group" class="svelte-1ps283u"><input name="task-name" type="text" placeholder="Whatcha doin?" spellcheck="true" list="list-task-names"> <!> <input type="submit" value="Start" class="svelte-1ps283u"></fieldset></form>');function Sa(e,t){ot(t,!0);let a=V("");function r(s){s.preventDefault(),t.onStartTask(b(a)),N(a,"")}var c=ba(),d=l(c),i=l(d);rt(i);var x=y(i,2);{var S=s=>{var n=xa();yt(n,21,()=>t.previousTasksList,Ht,(A,v)=>{var f=ya(),k={};B(()=>{k!==(k=b(v).name)&&(f.value=(f.__value=b(v).name)==null?"":b(v).name)}),w(A,f)}),u(n),w(s,n)};H(x,s=>{t.previousTasksList&&s(S)})}Tt(2),u(d),u(c),Nt("submit",c,r),it(i,()=>b(a),s=>N(a,s)),w(e,c),ct()}var Q,X,Y,$,tt;class wa{constructor(){K(this,Q,V(I([])));K(this,X,V(I([])));K(this,Y,V(I([])));K(this,$,V(I([])));K(this,tt,V(I([])));O(this,"intervalId")}get previouslyUsedTasks(){return b(F(this,Q))}set previouslyUsedTasks(t){N(F(this,Q),I(t))}get tasksRunning(){return b(F(this,X))}set tasksRunning(t){N(F(this,X),I(t))}get tasksPaused(){return b(F(this,Y))}set tasksPaused(t){N(F(this,Y),I(t))}get tasksStopped(){return b(F(this,$))}set tasksStopped(t){N(F(this,$),I(t))}get tasksArchived(){return b(F(this,tt))}set tasksArchived(t){N(F(this,tt),I(t))}start(){this.stop(),this.refresh();for(const t of this.tasksRunning)t.recalculateDurationFromRunningSession();this.intervalId=setInterval(()=>this.incrementRunningTaskDuration(),1e3)}stop(){this.intervalId&&clearInterval(this.intervalId)}refresh(){const t=vt.getAll().map(a=>new ut(a));this.previouslyUsedTasks=t.sort((a,r)=>a.date>r.date?-1:1).slice(0,20),this.tasksRunning=this.fetchTasksByState(t,[g.Running]),this.tasksPaused=this.fetchTasksByState(t,[g.Paused]),this.tasksStopped=this.fetchTasksByState(t,[g.Stopped]),this.tasksArchived=this.fetchTasksByState(t,[g.Archived])}fetchTasksByState(t,a){return t.filter(r=>a.includes(r.state))}startNewTask(t){const a=new ut;a.name=t,this.startTask(a)}saveTask(t){vt.set(t.id,t.getModel())}pauseAll(){this.refresh();for(const t of this.tasksRunning)t.pause(),this.saveTask(t);this.refresh()}incrementRunningTaskDuration(){for(const t of this.tasksRunning)t.setDuration(t.duration+1),this.saveTask(t)}pauseTask(t){t.pause(),this.saveTask(t),this.refresh()}startTask(t){this.pauseAll(),t.start(),this.saveTask(t),this.refresh()}stopTask(t){t.stop(),this.saveTask(t),this.refresh()}duplicateAndStartTask(t){const a=new ut(t.getModel(crypto.randomUUID()));a.setDuration(0),a.date=Zt.toInputDateValue(new Date),a.invoiceRefId="",this.startTask(a)}increaseDuration(t,a){t.incrementDuration(a),this.saveTask(t)}deleteTask(t){vt.remove(t.id),this.refresh()}}Q=new WeakMap,X=new WeakMap,Y=new WeakMap,$=new WeakMap,tt=new WeakMap;var Aa=D("<h2>Time Log</h2> <!> <section><summary> </summary> <!></section> <section><summary> </summary> <!></section> <section><details><summary> </summary> <!></details></section> <section><details><summary> </summary> <!></details></section>",1);function Ba(e,t){ot(t,!0);let a=I(new wa);Et(()=>{a.start()}),qt(()=>{a.stop()});var r=Aa(),c=y(nt(r),2);Sa(c,{onStartTask:M=>a.startNewTask(M),get previousTasksList(){return a.previouslyUsedTasks}});var d=y(c,2),i=l(d),x=l(i);u(i);var S=y(i,2);st(S,{get taskController(){return a},get tasks(){return a.tasksRunning}}),u(d);var s=y(d,2),n=l(s),A=l(n);u(n);var v=y(n,2);st(v,{get taskController(){return a},get tasks(){return a.tasksPaused}}),u(s);var f=y(s,2),k=l(f),o=l(k),h=l(o);u(o);var m=y(o,2);st(m,{get taskController(){return a},get tasks(){return a.tasksStopped}}),u(k),u(f);var z=y(f,2),j=l(z),T=l(j),p=l(T);u(T);var C=y(T,2);st(C,{get taskController(){return a},get tasks(){return a.tasksArchived}}),u(j),u(z),B(()=>{U(x,`In Progress (${a.tasksRunning.length??""})`),U(A,`Paused (${a.tasksPaused.length??""})`),U(h,`Stopped (${a.tasksStopped.length??""})`),U(p,`Archived (${a.tasksArchived.length??""})`)}),w(e,r),ct()}export{Ba as component};
