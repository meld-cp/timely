var Pt=Object.defineProperty;var vt=e=>{throw TypeError(e)};var zt=(e,t,a)=>t in e?Pt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var B=(e,t,a)=>zt(e,typeof t!="symbol"?t+"":t,a),Ft=(e,t,a)=>t.has(e)||vt("Cannot "+a);var L=(e,t,a)=>(Ft(e,t,"read from private field"),a?a.call(e):t.get(e)),G=(e,t,a)=>t.has(e)?vt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,a);import{d as mt,e as Mt,a as D,n as Lt,c as J,t as F}from"../chunks/disclose-version.ZjNFFspW.js";import{e as jt,k as ht,F as _t,h as Nt,l as kt,a6 as Ot,ax as Et,aw as Ht,I as qt,Z as at,j as Bt,E as Wt,aN as Ut,aO as Vt,m as Kt,u as Gt,Q as gt,as as Zt,q as Qt,i as Z,aP as Yt,aG as pt,af as yt,a0 as Jt,p as V,c as y,r as b,t as E,a as K,b as H,f as U,g as z,aA as Xt,s as C,B as Q,n as At,d as Y}from"../chunks/runtime.CMfmp5FK.js";import{b as $t,s as q}from"../chunks/render.BggfVEQa.js";import{p as j}from"../chunks/proxy.RwLPPeI8.js";import{o as te,a as ee}from"../chunks/index-client.DAFvqb0u.js";import{e as ae}from"../chunks/each.Dvc_xFwf.js";import{i as N}from"../chunks/if.BZPCAus2.js";import{b as se,s as bt,r as nt}from"../chunks/attributes.-KLHLZgj.js";import{d as Ct,k as re}from"../chunks/events.Ck8tAUNB.js";import{b as it}from"../chunks/input.Cjk_fENK.js";import{p as _,l as Tt,s as ne}from"../chunks/props.Bqb4XvXL.js";import"../chunks/legacy.DMhDkLsa.js";import{i as Rt}from"../chunks/lifecycle.CQgTHoCj.js";import{p as ft,i as ie,l as oe}from"../chunks/logger.D2MqzlnX.js";import{b as le}from"../chunks/this.2ZpSUIgT.js";import{T as x,a as lt,F as ce}from"../chunks/ViewModels.svelte.BsgVMvZK.js";import{t as ct}from"../chunks/Singletons.BXFbSXWe.js";function ue(e,t,a,r,l){var n=e,s="",v;jt(()=>{if(s===(s=t()??"")){ht&&_t();return}v!==void 0&&(Bt(v),v=void 0),s!==""&&(v=Nt(()=>{if(ht){kt.data;for(var k=_t(),c=k;k!==null&&(k.nodeType!==8||k.data!=="");)c=k,k=Ot(k);if(k===null)throw Et(),Ht;mt(kt,c),n=qt(k);return}var o=s+"";o=`<svg>${o}</svg>`;var T=Mt(o);for(T=at(T),mt(at(T),T.lastChild);at(T);)n.before(at(T))}))})}function fe(e,t,a){if(a){if(e.classList.contains(t))return;e.classList.add(t)}else{if(!e.classList.contains(t))return;e.classList.remove(t)}}const de=()=>performance.now(),O={tick:e=>requestAnimationFrame(e),now:()=>de(),tasks:new Set};function It(){const e=O.now();O.tasks.forEach(t=>{t.c(e)||(O.tasks.delete(t),t.f())}),O.tasks.size!==0&&O.tick(It)}function ve(e){let t;return O.tasks.size===0&&O.tick(It),{promise:new Promise(a=>{O.tasks.add(t={c:e,f:a})}),abort(){O.tasks.delete(t)}}}function st(e,t){e.dispatchEvent(new CustomEvent(t))}function me(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(a=>a[0].toUpperCase()+a.slice(1)).join("")}function wt(e){const t={},a=e.split(";");for(const r of a){const[l,n]=r.split(":");if(!l||n===void 0)break;const s=me(l.trim());t[s]=n.trim()}return t}const he=e=>e;function _e(e,t,a,r){var l=(e&Yt)!==0,n="both",s,v=t.inert,k=t.style.overflow,c,o;function T(){var f=Jt,d=gt;pt(null),yt(null);try{return s??(s=a()(t,(r==null?void 0:r())??{},{direction:n}))}finally{pt(f),yt(d)}}var m={is_global:l,in(){t.inert=v,st(t,"introstart"),c=dt(t,T(),o,1,()=>{st(t,"introend"),c==null||c.abort(),c=s=void 0,t.style.overflow=k})},out(f){t.inert=!0,st(t,"outrostart"),o=dt(t,T(),c,0,()=>{st(t,"outroend"),f==null||f()})},stop:()=>{c==null||c.abort(),o==null||o.abort()}},h=gt;if((h.transitions??(h.transitions=[])).push(m),$t){var g=l;if(!g){for(var i=h.parent;i&&i.f&Wt;)for(;(i=i.parent)&&!(i.f&Ut););g=!i||(i.f&Vt)!==0}g&&Kt(()=>{Gt(()=>m.in())})}}function dt(e,t,a,r,l){var n=r===1;if(Zt(t)){var s,v=!1;return Qt(()=>{if(!v){var f=t({direction:n?"in":"out"});s=dt(e,f,a,r,l)}}),{abort:()=>{v=!0,s==null||s.abort()},deactivate:()=>s.deactivate(),reset:()=>s.reset(),t:()=>s.t()}}if(a==null||a.deactivate(),!(t!=null&&t.duration))return l(),{abort:Z,deactivate:Z,reset:Z,t:()=>r};const{delay:k=0,css:c,tick:o,easing:T=he}=t;var m=[];if(n&&a===void 0&&(o&&o(0,1),c)){var h=wt(c(0,1));m.push(h,h)}var g=()=>1-r,i=e.animate(m,{duration:k});return i.onfinish=()=>{var f=(a==null?void 0:a.t())??1-r;a==null||a.abort();var d=r-f,S=t.duration*Math.abs(d),P=[];if(S>0){var p=!1;if(c)for(var w=Math.ceil(S/16.666666666666668),A=0;A<=w;A+=1){var u=f+d*T(A/w),I=wt(c(u,1-u));P.push(I),p||(p=I.overflow==="hidden")}p&&(e.style.overflow="hidden"),g=()=>{var R=i.currentTime;return f+d*T(R/S)},o&&ve(()=>{if(i.playState!=="running")return!1;var R=g();return o(R,1-R),!0})}i=e.animate(P,{duration:S,fill:"forwards"}),i.onfinish=()=>{g=()=>r,o==null||o(r,1-r),l()}},{abort:()=>{i&&(i.cancel(),i.effect=null,i.onfinish=Z)},deactivate:()=>{l=Z},reset:()=>{r===0&&(o==null||o(1,0))},t:()=>g()}}function ke(e){const{beat:t,fade:a,beatFade:r,bounce:l,shake:n,flash:s,spin:v,spinPulse:k,spinReverse:c,pulse:o,fixedWidth:T,inverse:m,border:h,listItem:g,flip:i,size:f,rotation:d,pull:S}=e,P={"fa-beat":t,"fa-fade":a,"fa-beat-fade":r,"fa-bounce":l,"fa-shake":n,"fa-flash":s,"fa-spin":v,"fa-spin-reverse":c,"fa-spin-pulse":k,"fa-pulse":o,"fa-fw":T,"fa-inverse":m,"fa-border":h,"fa-li":g,"fa-flip":i===!0,"fa-flip-horizontal":i==="horizontal"||i==="both","fa-flip-vertical":i==="vertical"||i==="both",[`fa-${f}`]:typeof f<"u"&&f!==null,[`fa-rotate-${d}`]:typeof d<"u"&&d!==null&&d!==0,[`fa-pull-${S}`]:typeof S<"u"&&S!==null,"fa-swap-opacity":e.swapOpacity};return Object.keys(P).map(p=>P[p]?p:null).filter(p=>p)}function ge(e){return e=e-0,e===e}function pe(e){return ge(e)?e:(e=e.replace(/[\-_\s]+(.)?/g,function(t,a){return a?a.toUpperCase():""}),e.substr(0,1).toLowerCase()+e.substr(1))}function ye(e){return typeof e=="string"?e:Object.keys(e).reduce((t,a)=>t+a.split(/(?=[A-Z])/).join("-").toLowerCase()+":"+e[a]+";","")}function Dt(e,t,a={}){if(typeof t=="string")return t;const r=(t.children||[]).map(n=>Dt(e,n)),l=Object.keys(t.attributes||{}).reduce((n,s)=>{const v=t.attributes[s];return s==="style"?n.attrs.style=ye(v):s.indexOf("aria-")===0||s.indexOf("data-")===0?n.attrs[s.toLowerCase()]=v:n.attrs[pe(s)]=v,n},{attrs:{}});return e(t.tag,{...l.attrs},r)}function St(e){if(e&&typeof e=="object"&&e.prefix&&e.iconName&&e.icon)return e;if(ft.icon)return ft.icon(e);if(e===null)return null;if(e&&typeof e=="object"&&e.prefix&&e.iconName)return e;if(Array.isArray(e)&&e.length===2)return{prefix:e[0],iconName:e[1]};if(typeof e=="string")return{prefix:"fas",iconName:e}}function ut(e,t){return Array.isArray(t)&&t.length>0||!Array.isArray(t)&&t?{[e]:t}:{}}var be=Lt("<svg><!></svg>");function Te(e,t){var i;V(t,!1);let a=_(t,"tag",8),r=_(t,"props",8),l=_(t,"children",8),n=_(t,"style",8,null),s=_(t,"ref",12,null);if(a()!=="svg")throw new Error('SvgElement requires a tag of "svg"');function v(f){return(f==null?void 0:f.reduce((d,S)=>d+(S.tag?k(S):S),""))||""}function k({tag:f,props:d,children:S}){const P=Object.keys(d).map(p=>`${p}="${d[p]}"`).join(" ");return`<${f} ${P}>${v(S)}</${f}>`}const c=v(l()),o=(i=r())!=null&&i.style?`${r().style}${n()||""}`:n(),T={...r(),style:o};Rt();var m=be();let h;var g=y(m);ue(g,()=>c),b(m),le(m,f=>s(f),()=>s()),E(()=>h=se(m,h,{...T},void 0,!0)),D(e,m),K()}function we(e,t){const a=Tt(t,["children","$$slots","$$events","$$legacy"]),r=Tt(a,["border","mask","maskId","fixedWidth","inverse","flip","icon","listItem","pull","pulse","rotation","size","spin","spinPulse","spinReverse","beat","fade","beatFade","bounce","shake","symbol","title","titleId","transform","swapOpacity","ref","style"]);V(t,!1),_(t,"border",8,!1);let l=_(t,"mask",8,null),n=_(t,"maskId",8,null);_(t,"fixedWidth",8,!1),_(t,"inverse",8,!1),_(t,"flip",8,!1);let s=_(t,"icon",8,null);_(t,"listItem",8,!1),_(t,"pull",8,null),_(t,"pulse",8,!1),_(t,"rotation",8,null),_(t,"size",8,null),_(t,"spin",8,!1),_(t,"spinPulse",8,!1),_(t,"spinReverse",8,!1),_(t,"beat",8,!1),_(t,"fade",8,!1),_(t,"beatFade",8,!1),_(t,"bounce",8,!1),_(t,"shake",8,!1);let v=_(t,"symbol",8,!1),k=_(t,"title",8,""),c=_(t,"titleId",8,null),o=_(t,"transform",8,null);_(t,"swapOpacity",8,!1);let T=_(t,"ref",12,null),m=_(t,"style",8,null);const h=St(s()),g=ut("classes",[...ke(a),...(a.class||"").split(" ")]),i=ut("transform",typeof o()=="string"?ft.transform(o()):o()),f=ut("mask",St(l())),d=ie(h,{...g,...i,...f,symbol:v(),title:k(),titleId:c(),maskId:n()});let S=Xt(null);if(!d)oe("Could not find icon",h);else{const{abstract:A}=d;H(S,Dt((u,I,R)=>({tag:u,props:I,children:R}),A[0],r))}Rt();var P=J(),p=U(P);{var w=A=>{Te(A,ne(()=>z(S),{get style(){return m()},get ref(){return T()},set ref(u){T(u)},$$legacy:!0}))};N(p,A=>{z(S)&&A(w)})}D(e,P),K()}/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const Se={prefix:"fas",iconName:"pause",icon:[320,512,[9208],"f04c","M48 64C21.5 64 0 85.5 0 112L0 400c0 26.5 21.5 48 48 48l32 0c26.5 0 48-21.5 48-48l0-288c0-26.5-21.5-48-48-48L48 64zm192 0c-26.5 0-48 21.5-48 48l0 288c0 26.5 21.5 48 48 48l32 0c26.5 0 48-21.5 48-48l0-288c0-26.5-21.5-48-48-48l-32 0z"]},xe={prefix:"fas",iconName:"eject",icon:[448,512,[9167],"f052","M224 32c13.5 0 26.3 5.6 35.4 15.6l176 192c12.9 14 16.2 34.3 8.6 51.8S419 320 400 320L48 320c-19 0-36.3-11.2-43.9-28.7s-4.3-37.7 8.6-51.8l176-192C197.7 37.6 210.5 32 224 32zM0 432c0-26.5 21.5-48 48-48l352 0c26.5 0 48 21.5 48 48s-21.5 48-48 48L48 480c-26.5 0-48-21.5-48-48z"]},Ae={prefix:"fas",iconName:"minus",icon:[448,512,[8211,8722,10134,"subtract"],"f068","M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"]},Ce={prefix:"fas",iconName:"stop",icon:[384,512,[9209],"f04d","M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z"]},Re={prefix:"fas",iconName:"play",icon:[384,512,[9654],"f04b","M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80L0 432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"]},Ie={prefix:"fas",iconName:"plus",icon:[448,512,[10133,61543,"add"],"2b","M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"]};function W(e,t){var a=J(),r=U(a);{var l=n=>{we(n,{get icon(){return t.icon}})};N(r,n=>{t.icon&&n(l)})}D(e,a)}var De=(e,t)=>t.onIncreaseDuration(!0,e.ctrlKey),Pe=(e,t)=>t.onIncreaseDuration(!1,e.ctrlKey),ze=F('<div class="c-buttons svelte-1ifz5q4"><button class="outline svelte-1ifz5q4" title="Add Time"><!></button> <button class="outline svelte-1ifz5q4" title="Remove Time"><!></button></div>'),Fe=(e,t)=>t.onAction1Click(),Me=F('<button class="outline svelte-1ifz5q4"><!></button>'),Le=F('<div class="icon"><!></div>'),je=(e,t)=>t.onAction2Click(),Ne=F('<button class="outline secondary svelte-1ifz5q4"><!></button>'),Oe=F('<div class="icon secondary"><!></div>'),Ee=F('<div class="c-buttons svelte-1ifz5q4"><!> <!></div>'),He=F('<div class="c-main svelte-1ifz5q4"><!> <div class="affective svelte-1ifz5q4"> </div> <div class="counter svelte-1ifz5q4"> </div> <!></div>');function qe(e,t){V(t,!0);let a=Q(()=>{const m=Math.floor(Math.abs(t.durationSeconds)/60/60),h=Math.floor(Math.abs(t.durationSeconds/60)),g=Math.abs(h%60),i=Math.abs(t.durationSeconds%60),f=[m.toFixed(0)+"h",g.toFixed(0)+"m",i.toFixed(0)+"s"];return(t.durationSeconds<0?"-":"")+f.join(" ")});var r=He(),l=y(r);{var n=m=>{var h=ze(),g=y(h);g.__click=[De,t];var i=y(g);W(i,{icon:Ie}),b(g);var f=C(g,2);f.__click=[Pe,t];var d=y(f);W(d,{icon:Ae}),b(f),b(h),D(m,h)};N(l,m=>{t.onIncreaseDuration&&m(n)})}var s=C(l,2),v=y(s,!0);E(()=>{var m;return q(v,(m=t.affectiveDurationHours)==null?void 0:m.toFixed(2))}),b(s);var k=C(s,2),c=y(k,!0);b(k);var o=C(k,2);{var T=m=>{var h=Ee(),g=y(h);{var i=p=>{var w=Me();w.__click=[Fe,t];var A=y(w);W(A,{get icon(){return t.icon1}}),b(w),E(()=>bt(w,"title",t.action1Hint)),D(p,w)},f=p=>{var w=J(),A=U(w);{var u=I=>{var R=Le(),ot=y(R);W(ot,{get icon(){return t.icon1}}),b(R),D(I,R)};N(A,I=>{t.icon1&&I(u)},!0)}D(p,w)};N(g,p=>{t.onAction1Click?p(i):p(f,!1)})}var d=C(g,2);{var S=p=>{var w=Ne();w.__click=[je,t];var A=y(w);W(A,{get icon(){return t.icon2}}),b(w),E(()=>bt(w,"title",t.action2Hint)),D(p,w)},P=p=>{var w=J(),A=U(w);{var u=I=>{var R=Oe(),ot=y(R);W(ot,{get icon(){return t.icon2}}),b(R),D(I,R)};N(A,I=>{t.icon2&&I(u)},!0)}D(p,w)};N(d,p=>{t.onAction2Click?p(S):p(P,!1)})}b(h),D(m,h)};N(o,m=>{(t.icon1||t.onAction1Click||t.icon2||t.onAction2Click)&&m(T)})}b(r),E(()=>q(c,z(a))),D(e,r),K()}Ct(["click"]);class M{}B(M,"TaskPause",Se),B(M,"TaskResume",Re),B(M,"TaskStop",Ce),B(M,"TaskDuplicateAndStart",xe);function xt(e,t,a){t.taskController.saveTask(a())}var Be=F('<span style="flex: content;" class="inv" title="Invoice"> </span>'),We=(e,t,a)=>{var r;return(r=t.taskController)==null?void 0:r.saveTask(a())},Ue=(e,t,a)=>t.taskController.deleteTask(a()),Ve=F('<article class="c-task svelte-5ojuwg"><div class="c-task-fields svelte-5ojuwg"><input class="date svelte-5ojuwg" name="task-date" type="date" title="Date"> <input class="name svelte-5ojuwg" name="task-name" type="text" title="Description" placeholder="Description"> <div class="c-task-fields-row-2 svelte-5ojuwg"><details class="svelte-5ojuwg"><summary class="svelte-5ojuwg">Other</summary> <!> <div style="display: flex; flex-direction: row; gap:1rem; flex-wrap: wrap;"><input style="flex: 10;" class="tags svelte-5ojuwg" name="task-tags" type="text" placeholder="Tags" title="Tags"> <button style="flex: content;" class="svelte-5ojuwg">Delete</button></div></details> <div style="flex: 2;"></div></div></div> <div class="c-task-duration svelte-5ojuwg"><!></div></article>');function Ke(e,t){V(t,!0);let a=_(t,"vm",7);const r={icon:u=>{switch(u.state){case x.Running:return M.TaskPause;case x.Paused:return M.TaskResume;case x.Stopped:return M.TaskDuplicateAndStart}},hint:u=>{switch(u.state){case x.Running:return"Pause";case x.Paused:return"Resume";case x.Stopped:return"Start a new copy"}},execute:u=>{switch(u.state){case x.Running:t.taskController.pauseTask(u);break;case x.Paused:t.taskController.startTask(u);break;case x.Stopped:t.taskController.duplicateAndStartTask(u);break}}},l={icon:u=>{switch(u.state){case x.Running:return M.TaskStop;case x.Paused:return M.TaskStop;case x.Stopped:return M.TaskResume}},hint:u=>{switch(u.state){case x.Running:return"Stop";case x.Paused:return"Stop";case x.Stopped:return"Start"}},execute:u=>{switch(u.state){case x.Running:t.taskController.stopTask(u);break;case x.Paused:t.taskController.stopTask(u);break;case x.Stopped:t.taskController.startTask(u);break}}};function n(u,I){let R=I?1:15;t.taskController.increaseDuration(a(),u?R:-R)}var s=Ve(),v=y(s),k=y(v);nt(k),k.__input=[xt,t,a];var c=C(k,2);nt(c),c.__input=[xt,t,a];var o=C(c,2),T=y(o),m=C(y(T),2);{var h=u=>{var I=Be(),R=y(I);b(I),E(()=>q(R,`Attached to Invoice Id: ${a().invoiceRefId??""}`)),D(u,I)};N(m,u=>{a().invoiceRefId.length>0&&u(h)})}var g=C(m,2),i=y(g);nt(i),i.__input=[We,t,a];var f=C(i,2);f.__click=[Ue,t,a],b(g),b(T),At(2),b(o),b(v);var d=C(v,2),S=y(d),P=Q(()=>r.icon(a())),p=Q(()=>r.hint(a())),w=Q(()=>l.icon(a())),A=Q(()=>l.hint(a()));qe(S,{get durationSeconds(){return a().duration},get affectiveDurationHours(){return a().affectiveDurationHours},onIncreaseDuration:n,get icon1(){return z(P)},onAction1Click:()=>r.execute(a()),get action1Hint(){return z(p)},get icon2(){return z(w)},onAction2Click:()=>l.execute(a()),get action2Hint(){return z(A)}}),b(d),b(s),E(()=>fe(s,"s-running",a().state==x.Running)),it(k,()=>a().date,u=>a().date=u),it(c,()=>a().name,u=>a().name=u),it(i,()=>a().tagsAsText,u=>a().tagsAsText=u),D(e,s),K()}Ct(["input","click"]);function Ge(e){const t=e-1;return t*t*t+1}function Ze(e,{delay:t=0,duration:a=400,easing:r=Ge,axis:l="y"}={}){const n=getComputedStyle(e),s=+n.opacity,v=l==="y"?"height":"width",k=parseFloat(n[v]),c=l==="y"?["top","bottom"]:["left","right"],o=c.map(d=>`${d[0].toUpperCase()}${d.slice(1)}`),T=parseFloat(n[`padding${o[0]}`]),m=parseFloat(n[`padding${o[1]}`]),h=parseFloat(n[`margin${o[0]}`]),g=parseFloat(n[`margin${o[1]}`]),i=parseFloat(n[`border${o[0]}Width`]),f=parseFloat(n[`border${o[1]}Width`]);return{delay:t,duration:a,easing:r,css:d=>`overflow: hidden;opacity: ${Math.min(d*20,1)*s};${v}: ${d*k}px;padding-${c[0]}: ${d*T}px;padding-${c[1]}: ${d*m}px;margin-${c[0]}: ${d*h}px;margin-${c[1]}: ${d*g}px;border-${c[0]}-width: ${d*i}px;border-${c[1]}-width: ${d*f}px;min-${v}: 0`}}var Qe=F("<div><!></div>");function rt(e,t){var a=J(),r=U(a);ae(r,19,()=>t.tasks,l=>l.id,(l,n)=>{var s=Qe(),v=y(s);Ke(v,{get vm(){return z(n)},get taskController(){return t.taskController}}),b(s),_e(3,s,()=>Ze,()=>({duration:200})),D(l,s)}),D(e,a)}var Ye=F('<form><fieldset role="group" class="svelte-1ps283u"><input id="taskname" type="text" placeholder="Whatcha doin?" autocorrect="on" autocomplete="on"> <input type="submit" value="Start" class="svelte-1ps283u"></fieldset></form>');function Je(e,t){V(t,!0);let a=Y("");function r(v){v.preventDefault(),t.onStartTask(z(a)),H(a,"")}var l=Ye(),n=y(l),s=y(n);nt(s),At(2),b(n),b(l),re("submit",l,r),it(s,()=>z(a),v=>H(a,v)),D(e,l),K()}var X,$,tt,et;class Xe{constructor(){G(this,X,Y(j([])));G(this,$,Y(j([])));G(this,tt,Y(j([])));G(this,et,Y(j([])));B(this,"intervalId")}get tasksRunning(){return z(L(this,X))}set tasksRunning(t){H(L(this,X),j(t))}get tasksPaused(){return z(L(this,$))}set tasksPaused(t){H(L(this,$),j(t))}get tasksStopped(){return z(L(this,tt))}set tasksStopped(t){H(L(this,tt),j(t))}get tasksArchived(){return z(L(this,et))}set tasksArchived(t){H(L(this,et),j(t))}start(){this.stop(),this.refresh();for(const t of this.tasksRunning)t.recalculateDurationFromRunningSession();this.intervalId=setInterval(()=>this.incrementRunningTaskDuration(),1e3)}stop(){this.intervalId&&clearInterval(this.intervalId)}refresh(){const t=ct.getAll().map(a=>new lt(a));this.tasksRunning=this.fetchTasksByState(t,[x.Running]),this.tasksPaused=this.fetchTasksByState(t,[x.Paused]),this.tasksStopped=this.fetchTasksByState(t,[x.Stopped]),this.tasksArchived=this.fetchTasksByState(t,[x.Archived])}fetchTasksByState(t,a){return t.filter(r=>a.includes(r.state))}startNewTask(t){const a=new lt;a.name=t,this.startTask(a)}saveTask(t){ct.set(t.id,t.getModel())}pauseAll(){this.refresh();for(const t of this.tasksRunning)t.pause(),this.saveTask(t);this.refresh()}incrementRunningTaskDuration(){for(const t of this.tasksRunning)t.setDuration(t.duration+1),this.saveTask(t)}pauseTask(t){t.pause(),this.saveTask(t),this.refresh()}startTask(t){this.pauseAll(),t.start(),this.saveTask(t),this.refresh()}stopTask(t){t.stop(),this.saveTask(t),this.refresh()}duplicateAndStartTask(t){const a=new lt(t.getModel(crypto.randomUUID()));a.setDuration(0),a.date=ce.toInputDateValue(new Date),a.invoiceRefId="",this.startTask(a)}increaseDuration(t,a){t.incrementDuration(a),this.saveTask(t)}deleteTask(t){ct.remove(t.id),this.refresh()}}X=new WeakMap,$=new WeakMap,tt=new WeakMap,et=new WeakMap;var $e=F("<h2>Time Log</h2> <!> <section><summary> </summary> <!></section> <section><summary> </summary> <!></section> <section><details><summary> </summary> <!></details></section> <section><details><summary> </summary> <!></details></section>",1);function ga(e,t){V(t,!0);let a=j(new Xe);te(()=>{a.start()}),ee(()=>{a.stop()});var r=$e(),l=C(U(r),2);Je(l,{onStartTask:u=>a.startNewTask(u)});var n=C(l,2),s=y(n),v=y(s);b(s);var k=C(s,2);rt(k,{get taskController(){return a},get tasks(){return a.tasksRunning}}),b(n);var c=C(n,2),o=y(c),T=y(o);b(o);var m=C(o,2);rt(m,{get taskController(){return a},get tasks(){return a.tasksPaused}}),b(c);var h=C(c,2),g=y(h),i=y(g),f=y(i);b(i);var d=C(i,2);rt(d,{get taskController(){return a},get tasks(){return a.tasksStopped}}),b(g),b(h);var S=C(h,2),P=y(S),p=y(P),w=y(p);b(p);var A=C(p,2);rt(A,{get taskController(){return a},get tasks(){return a.tasksArchived}}),b(P),b(S),E(()=>{q(v,`In Progress (${a.tasksRunning.length??""})`),q(T,`Paused (${a.tasksPaused.length??""})`),q(f,`Stopped (${a.tasksStopped.length??""})`),q(w,`Archived (${a.tasksArchived.length??""})`)}),D(e,r),K()}export{ga as component};
