var z=o=>{throw TypeError(o)};var J=(o,t,r)=>t.has(o)||z("Cannot "+r);var e=(o,t,r)=>(J(o,t,"read from private field"),r?r.call(o):t.get(o)),s=(o,t,r)=>t.has(o)?z("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(o):t.set(o,r);import{W as u,o as n,N as a,v as c}from"./B3quWTxq.js";import{p as i}from"./DwbFJCge.js";import{F as G}from"./DvTEyFA3.js";import{t as K}from"./Co2-gIP7.js";var h=(o=>(o[o.Running=0]="Running",o[o.Paused=1]="Paused",o[o.Stopped=2]="Stopped",o[o.Archived=3]="Archived",o))(h||{}),f,l,g,p,R,m,v,D,I;class tt{constructor(t){s(this,f,u(i(crypto.randomUUID())));s(this,l,u(i(h.Stopped)));s(this,g,u(i(G.toInputDateValue(new Date))));s(this,p,u(""));s(this,R,u(0));s(this,m,u(0));s(this,v,u());s(this,D,u(""));s(this,I,u(i([])));t&&this.applyModel(t)}get id(){return n(e(this,f))}set id(t){a(e(this,f),i(t))}get state(){return n(e(this,l))}set state(t){a(e(this,l),i(t))}get date(){return n(e(this,g))}set date(t){a(e(this,g),i(t))}get name(){return n(e(this,p))}set name(t){a(e(this,p),i(t))}get duration(){return n(e(this,R))}set duration(t){a(e(this,R),i(t))}get affectiveDurationHours(){return n(e(this,m))}set affectiveDurationHours(t){a(e(this,m),i(t))}get timeRunStarted(){return n(e(this,v))}set timeRunStarted(t){a(e(this,v),i(t))}get invoiceRefId(){return n(e(this,D))}set invoiceRefId(t){a(e(this,D),i(t))}get tags(){return n(e(this,I))}set tags(t){a(e(this,I),i(t))}get tagsAsText(){return this.tags.join(" ")}set tagsAsText(t){this.tags=t.trim().split(" ")}getModel(t){return{id:t??this.id,state:this.state,date:this.date,name:this.name,duration:this.duration,affectiveDurationHours:this.affectiveDurationHours,timeRunStarted:this.timeRunStarted,invoiceRefId:this.invoiceRefId,tags:this.tags}}applyModel(t){this.id=t.id,this.state=t.state,this.date=t.date,this.name=t.name,this.duration=t.duration,this.affectiveDurationHours=t.affectiveDurationHours,this.timeRunStarted=t.timeRunStarted,this.invoiceRefId=t.invoiceRefId,this.tags=t.tags}save(){K.set(this.id,this.getModel())}pause(){this.state==h.Running&&(this.state=h.Paused,this.timeRunStarted=void 0)}start(){this.state=h.Running,this.timeRunStarted=Date.now()}stop(){this.state=h.Stopped,this.timeRunStarted=void 0}incrementDuration(t){if(this.state==h.Running){const r=this.timeRunStarted??Date.now(),d=t*60*1e3,Z=r-d;this.timeRunStarted=Z,this.recalculateDurationFromRunningSession()}else this.setDuration(this.duration+t*60)}recalculateDurationFromRunningSession(){if(this.state!=h.Running)return;const t=this.timeRunStarted??Date.now(),r=(Date.now()-t)/1e3;this.setDuration(r)}setDuration(t){this.duration=Math.ceil(t),this.affectiveDurationHours=this.calculateAffectiveHours(this.duration,15)}calculateAffectiveHours(t,r){let d=t/60;return Math.ceil(d/r)*r/60}}f=new WeakMap,l=new WeakMap,g=new WeakMap,p=new WeakMap,R=new WeakMap,m=new WeakMap,v=new WeakMap,D=new WeakMap,I=new WeakMap;var x,y,L,T,b,S,M,C,j,P,E;class et{constructor(t){s(this,x,u(i(crypto.randomUUID().toString())));s(this,y,u("NZD"));s(this,L,u(""));s(this,T,u(i(G.toInputDateValue(new Date))));s(this,b,u(""));s(this,S,u(i([])));s(this,M,u(i([])));s(this,C,u(i([])));s(this,j,c(()=>this.lines.reduce((t,r)=>t+r.total,0)));s(this,P,c(()=>this.lines.reduce((t,r)=>t+r.tax,0)));s(this,E,c(()=>this.subtotal+this.taxTotal));t&&this.applyModel(t)}get id(){return n(e(this,x))}set id(t){a(e(this,x),i(t))}get currencyCode(){return n(e(this,y))}set currencyCode(t){a(e(this,y),i(t))}get number(){return n(e(this,L))}set number(t){a(e(this,L),i(t))}get date(){return n(e(this,T))}set date(t){a(e(this,T),i(t))}get orderRef(){return n(e(this,b))}set orderRef(t){a(e(this,b),i(t))}get issueToLines(){return n(e(this,S))}set issueToLines(t){a(e(this,S),i(t))}get footerLines(){return n(e(this,M))}set footerLines(t){a(e(this,M),i(t))}get lines(){return n(e(this,C))}set lines(t){a(e(this,C),i(t))}get subtotal(){return n(e(this,j))}get taxTotal(){return n(e(this,P))}get grandTotal(){return n(e(this,E))}getModel(){return{id:this.id,currencyCode:this.currencyCode,number:this.number,date:this.date,orderRef:this.orderRef,issueToLines:this.issueToLines,lines:this.lines.map(t=>t.getModel()),footerLines:this.footerLines}}applyModel(t){this.id=t.id,this.currencyCode=t.currencyCode,this.number=t.number,this.date=t.date,this.orderRef=t.orderRef,this.issueToLines=t.issueToLines,this.lines=t.lines.map(r=>new B(r)),this.footerLines=t.footerLines}get issueToAsText(){return this.issueToLines.join(`
`)}set issueToAsText(t){this.issueToLines=t.split(`
`)}get footnoteAsText(){return this.footerLines.join(`
`)}set footnoteAsText(t){this.footerLines=t.split(`
`)}containsExtRefId(t){return this.lines.some(d=>d.extRefId===t)}removeLineWithExtRefId(t){this.lines=this.lines.filter(r=>r.extRefId!=t)}addLine(t){const r=t??new B;return this.lines.push(r),r.id}sortLines(){}}x=new WeakMap,y=new WeakMap,L=new WeakMap,T=new WeakMap,b=new WeakMap,S=new WeakMap,M=new WeakMap,C=new WeakMap,j=new WeakMap,P=new WeakMap,E=new WeakMap;var w,H,A,q,U,V,F,N,W;class B{constructor(t){s(this,w,u(i(crypto.randomUUID().toString())));s(this,H,u());s(this,A,u(0));s(this,q,u(""));s(this,U,u(""));s(this,V,u(0));s(this,F,u(0));s(this,N,c(()=>0));s(this,W,c(()=>this.quantity*this.unitCost));t&&this.applyModel(t)}get id(){return n(e(this,w))}set id(t){a(e(this,w),i(t))}get extRefId(){return n(e(this,H))}set extRefId(t){a(e(this,H),i(t))}get number(){return n(e(this,A))}set number(t){a(e(this,A),i(t))}get description(){return n(e(this,q))}set description(t){a(e(this,q),i(t))}get units(){return n(e(this,U))}set units(t){a(e(this,U),i(t))}get quantity(){return n(e(this,V))}set quantity(t){a(e(this,V),i(t))}get unitCost(){return n(e(this,F))}set unitCost(t){a(e(this,F),i(t))}get tax(){return n(e(this,N))}get total(){return n(e(this,W))}getModel(){return{id:this.id,extRefId:this.extRefId,number:this.number,description:this.description,units:this.units,quantity:this.quantity,unitCost:this.unitCost}}applyModel(t){this.id=t.id,this.extRefId=t.extRefId,this.number=t.number,this.description=t.description,this.units=t.units,this.quantity=t.quantity,this.unitCost=t.unitCost}}w=new WeakMap,H=new WeakMap,A=new WeakMap,q=new WeakMap,U=new WeakMap,V=new WeakMap,F=new WeakMap,N=new WeakMap,W=new WeakMap;export{et as I,h as T,tt as a,B as b};
