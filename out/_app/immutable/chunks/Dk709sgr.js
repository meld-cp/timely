var p=Object.defineProperty;var k=o=>{throw TypeError(o)};var N=(o,e,t)=>e in o?p(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var m=(o,e,t)=>N(o,typeof e!="symbol"?e+"":e,t),P=(o,e,t)=>e.has(o)||k("Cannot "+t);var s=(o,e,t)=>(P(o,e,"read from private field"),t?t.call(o):e.get(o)),a=(o,e,t)=>e.has(o)?k("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,t);import{W as n,o as c,N as l}from"./B3quWTxq.js";import{p as i}from"./DwbFJCge.js";class S{constructor(e){m(this,"bucket");this.bucket=e}encode(e){return JSON.stringify(e)}dencode(e){return JSON.parse(e)}buildBucketKey(e){return[this.bucket,e].join("$")}matchesBucketKey(e){return e.startsWith(this.bucket+"$")}set(e,t){const r=this.buildBucketKey(e),C=this.encode(t);localStorage.setItem(r,C)}get(e,t){const r=this.buildBucketKey(e);return this.getWithKey(r)}getWithKey(e){const t=localStorage.getItem(e);return t===null?null:this.dencode(t)}getAll(){const e=[];for(let t=0;t<localStorage.length;t++){const r=localStorage.key(t);if(r==null)return e;if(!this.matchesBucketKey(r))continue;const C=this.getWithKey(r);C&&e.push(C)}return e}remove(e){const t=this.buildBucketKey(e);localStorage.removeItem(t)}removeAll(){const e=[];for(let t=0;t<localStorage.length;t++){const r=localStorage.key(t);if(r==null)break;this.matchesBucketKey(r)&&e.push(r)}for(const t of e)localStorage.removeItem(t)}}var d,u,h,g,v,f,y,I;class b{constructor(e){a(this,d,n(i(navigator.language)));a(this,u,n());a(this,h,n());a(this,g,n(1e3));a(this,v,n(i({})));a(this,f,n());a(this,y,n("USD"));a(this,I,n());e&&this.applyModel(e)}get localeCode(){return c(s(this,d))}set localeCode(e){l(s(this,d),i(e))}get address(){return c(s(this,u))}set address(e){l(s(this,u),i(e))}get logoData(){return c(s(this,h))}set logoData(e){l(s(this,h),i(e))}get nextInvoiceNumber(){return c(s(this,g))}set nextInvoiceNumber(e){l(s(this,g),i(e))}get scratchPads(){return c(s(this,v))}set scratchPads(e){l(s(this,v),i(e))}get invoiceHeader(){return c(s(this,f))}set invoiceHeader(e){l(s(this,f),i(e))}get defaultInvoiceCurrencyCode(){return c(s(this,y))}set defaultInvoiceCurrencyCode(e){l(s(this,y),i(e))}get defaultInvoiceFooter(){return c(s(this,I))}set defaultInvoiceFooter(e){l(s(this,I),i(e))}applyModel(e){this.localeCode=e.localeCode??navigator.language,this.address=e.address??"",this.logoData=e.logoData,this.nextInvoiceNumber=e.nextInvoiceNumber??1e3,this.invoiceHeader=e.invoiceHeader,this.defaultInvoiceCurrencyCode=e.defaultInvoiceCurrencyCode??"USD",this.defaultInvoiceFooter=e.defaultInvoiceFooter,this.scratchPads=e.scratchPads??{}}getModel(){return{localeCode:this.localeCode,address:this.address,logoData:this.logoData,nextInvoiceNumber:this.nextInvoiceNumber,invoiceHeader:this.invoiceHeader,defaultInvoiceCurrencyCode:this.defaultInvoiceCurrencyCode,defaultInvoiceFooter:this.defaultInvoiceFooter,scratchPads:this.scratchPads}}}d=new WeakMap,u=new WeakMap,h=new WeakMap,g=new WeakMap,v=new WeakMap,f=new WeakMap,y=new WeakMap,I=new WeakMap;class x{constructor(){m(this,"defaultSettings",{localeCode:navigator.language,nextInvoiceNumber:1e3,defaultInvoiceCurrencyCode:"USD",scratchPads:{}})}modify(e){const t=this.read();e(t),this.write(t)}read(){const e=localStorage.getItem("settings");return e?new b(JSON.parse(e)||this.defaultSettings):new b(this.defaultSettings)}write(e){const t=JSON.stringify(e.getModel());localStorage.setItem("settings",t)}incrementNextInvoiceNumber(){this.modify(e=>{e.nextInvoiceNumber++})}getScratchPad(e){return this.read().scratchPads[e]??""}setScratchPad(e,t){this.modify(r=>{r.scratchPads[e]=t})}}const B=new S("tasks"),F=new S("invoices"),H=new S("invoice-previews"),M=new x;export{F as a,H as i,M as s,B as t};
