var x=Object.defineProperty;var k=o=>{throw TypeError(o)};var F=(o,e,t)=>e in o?x(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var C=(o,e,t)=>F(o,typeof e!="symbol"?e+"":e,t),P=(o,e,t)=>e.has(o)||k("Cannot "+t);var r=(o,e,t)=>(P(o,e,"read from private field"),t?t.call(o):e.get(o)),n=(o,e,t)=>e.has(o)?k("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,t);import{W as c,o as l,N as u}from"./CRiTDDG9.js";import{p as a}from"./dGNHEYVr.js";class b{static padLeft(e,t,s){const i=s-e.length;for(let S=0;S<i;S++)e=t[0]+e;return e}}class D{static toInputDateValue(e){var t=e.getDate(),s=e.getMonth()+1,i=e.getFullYear();return`${i}-${b.padLeft(s.toString(),"0",2)}-${b.padLeft(t.toString(),"0",2)}`}static toLocalDatefromString(e,t){const s=new Date(e);return D.toLocalDate(s,t)}static toLocalDate(e,t){return new Intl.DateTimeFormat(t,{}).format(e)}}class N{constructor(e){C(this,"bucket");this.bucket=e}encode(e){return JSON.stringify(e)}dencode(e){return JSON.parse(e)}buildBucketKey(e){return[this.bucket,e].join("$")}matchesBucketKey(e){return e.startsWith(this.bucket+"$")}set(e,t){const s=this.buildBucketKey(e),i=this.encode(t);localStorage.setItem(s,i)}get(e,t){const s=this.buildBucketKey(e);return this.getWithKey(s)}getWithKey(e){const t=localStorage.getItem(e);return t===null?null:this.dencode(t)}getAll(){const e=[];for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);if(s==null)return e;if(!this.matchesBucketKey(s))continue;const i=this.getWithKey(s);i&&e.push(i)}return e}remove(e){const t=this.buildBucketKey(e);localStorage.removeItem(t)}removeAll(){const e=[];for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);if(s==null)break;this.matchesBucketKey(s)&&e.push(s)}for(const t of e)localStorage.removeItem(t)}}var d,h,g,v,f,y,I,m;class p{constructor(e){n(this,d,c(a(navigator.language)));n(this,h,c());n(this,g,c());n(this,v,c(1e3));n(this,f,c(a({})));n(this,y,c());n(this,I,c("USD"));n(this,m,c());e&&this.applyModel(e)}get localeCode(){return l(r(this,d))}set localeCode(e){u(r(this,d),a(e))}get address(){return l(r(this,h))}set address(e){u(r(this,h),a(e))}get logoData(){return l(r(this,g))}set logoData(e){u(r(this,g),a(e))}get nextInvoiceNumber(){return l(r(this,v))}set nextInvoiceNumber(e){u(r(this,v),a(e))}get scratchPads(){return l(r(this,f))}set scratchPads(e){u(r(this,f),a(e))}get invoiceHeader(){return l(r(this,y))}set invoiceHeader(e){u(r(this,y),a(e))}get defaultInvoiceCurrencyCode(){return l(r(this,I))}set defaultInvoiceCurrencyCode(e){u(r(this,I),a(e))}get defaultInvoiceFooter(){return l(r(this,m))}set defaultInvoiceFooter(e){u(r(this,m),a(e))}applyModel(e){this.localeCode=e.localeCode??navigator.language,this.address=e.address??"",this.logoData=e.logoData,this.nextInvoiceNumber=e.nextInvoiceNumber??1e3,this.invoiceHeader=e.invoiceHeader,this.defaultInvoiceCurrencyCode=e.defaultInvoiceCurrencyCode??"USD",this.defaultInvoiceFooter=e.defaultInvoiceFooter,this.scratchPads=e.scratchPads??{}}getModel(){return{localeCode:this.localeCode,address:this.address,logoData:this.logoData,nextInvoiceNumber:this.nextInvoiceNumber,invoiceHeader:this.invoiceHeader,defaultInvoiceCurrencyCode:this.defaultInvoiceCurrencyCode,defaultInvoiceFooter:this.defaultInvoiceFooter,scratchPads:this.scratchPads}}}d=new WeakMap,h=new WeakMap,g=new WeakMap,v=new WeakMap,f=new WeakMap,y=new WeakMap,I=new WeakMap,m=new WeakMap;class w{constructor(){C(this,"defaultSettings",{localeCode:navigator.language,nextInvoiceNumber:1e3,defaultInvoiceCurrencyCode:"USD",scratchPads:{}})}modify(e){const t=this.read();e(t),this.write(t)}read(){const e=localStorage.getItem("settings");return e?new p(JSON.parse(e)||this.defaultSettings):new p(this.defaultSettings)}write(e){const t=JSON.stringify(e.getModel());localStorage.setItem("settings",t)}incrementNextInvoiceNumber(){this.modify(e=>{e.nextInvoiceNumber++})}getScratchPad(e){return this.read().scratchPads[e]??""}setScratchPad(e,t){this.modify(s=>{s.scratchPads[e]=t})}}const L=new N("tasks"),M=new N("invoices"),W=new w;export{D as F,M as i,W as s,L as t};
